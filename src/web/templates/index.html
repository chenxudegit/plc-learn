<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工业设备数据模拟系统</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>工业设备数据模拟系统</h1>
            <p>实时监控工业设备运行状态和数据</p>
            <div class="system-status">
                <span id="system-uptime">系统状态: 运行中</span>
                <span id="last-update">最后更新: --</span>
            </div>
        </header>
        
        <nav>
            <ul>
                <li><a href="#dashboard" class="active">仪表板</a></li>
                <li><a href="#devices">设备管理</a></li>
                <li><a href="#analysis">数据分析</a></li>
                <li><a href="#realtime">实时监控</a></li>
                <li><a href="#settings">系统设置</a></li>
            </ul>
        </nav>
        
        <main>
            <section id="dashboard" class="dashboard active">
                <h2>系统仪表板</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>设备状态</h3>
                        <div id="device-status" class="status-content">加载中...</div>
                    </div>
                    <div class="stat-card">
                        <h3>数据统计</h3>
                        <div id="data-stats" class="stats-content">加载中...</div>
                    </div>
                    <div class="stat-card">
                        <h3>系统信息</h3>
                        <div id="system-info" class="info-content">加载中...</div>
                    </div>
                </div>
                
                <div class="quick-actions">
                    <button onclick="refreshData()" class="btn btn-primary">刷新数据</button>
                    <button onclick="exportData()" class="btn btn-secondary">导出数据</button>
                    <button onclick="showRealtime()" class="btn btn-success">实时监控</button>
                </div>
            </section>
            
            <section id="devices" class="devices">
                <h2>设备管理</h2>
                <div class="device-grid" id="device-list">
                    <div class="loading">加载设备信息...</div>
                </div>
            </section>
            
            <section id="analysis" class="analysis">
                <h2>数据分析</h2>
                <div class="analysis-controls">
                    <select id="analysis-device" onchange="updateAnalysis()">
                        <option value="">选择设备</option>
                    </select>
                    <select id="analysis-type" onchange="updateAnalysis()">
                        <option value="all">所有数据类型</option>
                        <option value="temperature">温度</option>
                        <option value="pressure">压力</option>
                        <option value="flow">流量</option>
                        <option value="status">状态</option>
                    </select>
                    <select id="analysis-time" onchange="updateAnalysis()">
                        <option value="1">最近1小时</option>
                        <option value="6">最近6小时</option>
                        <option value="24" selected>最近24小时</option>
                        <option value="168">最近7天</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="data-chart"></canvas>
                </div>
                <div class="analysis-summary" id="analysis-summary">
                    <h3>分析摘要</h3>
                    <div id="analysis-results">选择设备和参数进行分析</div>
                </div>
            </section>
            
            <section id="realtime" class="realtime">
                <h2>实时监控</h2>
                <div class="realtime-grid">
                    <div class="realtime-card">
                        <h3>端子定位检测机</h3>
                        <div id="modbus-realtime" class="realtime-data">
                            <div class="data-item">
                                <span class="label">温度:</span>
                                <span class="value" id="modbus-temp">--</span>
                                <span class="unit">°C</span>
                            </div>
                            <div class="data-item">
                                <span class="label">压力:</span>
                                <span class="value" id="modbus-pressure">--</span>
                                <span class="unit">MPa</span>
                            </div>
                            <div class="data-item">
                                <span class="label">流量:</span>
                                <span class="value" id="modbus-flow">--</span>
                                <span class="unit">L/min</span>
                            </div>
                            <div class="data-item">
                                <span class="label">状态:</span>
                                <span class="value" id="modbus-status">--</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="realtime-card">
                        <h3>D-1夹具机器手臂</h3>
                        <div id="socket-realtime" class="realtime-data">
                            <div class="data-item">
                                <span class="label">计数器:</span>
                                <span class="value" id="socket-counter">--</span>
                            </div>
                            <div class="data-item">
                                <span class="label">状态:</span>
                                <span class="value" id="socket-status">--</span>
                            </div>
                            <div class="data-item">
                                <span class="label">更新时间:</span>
                                <span class="value" id="socket-time">--</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="realtime-chart">
                    <canvas id="realtime-chart"></canvas>
                </div>
            </section>
            
            <section id="settings" class="settings">
                <h2>系统设置</h2>
                <div class="settings-form">
                    <div class="form-group">
                        <label>数据刷新间隔 (秒):</label>
                        <input type="number" id="refresh-interval" value="5" min="1" max="60">
                    </div>
                    <div class="form-group">
                        <label>图表显示点数:</label>
                        <input type="number" id="chart-points" value="100" min="10" max="1000">
                    </div>
                    <div class="form-group">
                        <label>自动刷新:</label>
                        <input type="checkbox" id="auto-refresh" checked>
                    </div>
                    <button onclick="saveSettings()" class="btn btn-primary">保存设置</button>
                </div>
            </section>
        </main>
    </div>
    
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
